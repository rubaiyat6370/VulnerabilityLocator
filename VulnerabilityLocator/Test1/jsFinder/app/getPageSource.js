function DOMtoString(a) {
    var b = "";
    for (a = a.firstChild; a;) {
        switch (a.nodeType) {
            case Node.ELEMENT_NODE:
                b += a.outerHTML;
                break;
            case Node.TEXT_NODE:
                b += a.nodeValue;
                break;
            case Node.CDATA_SECTION_NODE:
                b += "<![CDATA[" + a.nodeValue + "]]\x3e";
                break;
            case Node.COMMENT_NODE:
                b += "\x3c!--" + a.nodeValue + "--\x3e";
                break;
            case Node.DOCUMENT_TYPE_NODE:
                b += "<!DOCTYPE " + a.name + (a.publicId ? ' PUBLIC "' + a.publicId + '"' : "") + (!a.publicId && a.systemId ? " SYSTEM" : "") + (a.systemId ? ' "' + a.systemId + '"' : "") + ">\n"
        }
        a = a.nextSibling
    }
    return b
}
chrome.runtime.sendMessage({
    action: "getSource",
    source: DOMtoString(document)
});
